PT-PT

Trabalho Prático - Transferência rápida e fiável de múltiplos servidores em simultâneo

- Motivação:
	A partilha de ficheiros é um dos serviços essenciais de uma rede. Permite que um programa cliente identifique o ficheiro e o descarregue de um servidor que o disponibiliza. O serviço tem como requisito base que a transferência seja fiável. Os dados devem ser descarregados e guardados sem erros. A réplica descarregada pelo cliente é uma cópia integral da existente no servidor, cuja integridade pode ser verificada. Os protocolos desenhados para a transferência de ficheiros procuram garantir os requisitos base, mas também assegurar um bom desempenho na transferência. Neste trabalho pretende-se desenhar um serviço avançado de transferência de ficheiros, numa rede peer-to-peer (P2P) com múltiplos servidores, que são também clientes do mesmo serviço. São por isso pares que dialogam entre si. Num dado instante, um ficheiro pode estar disponível em mais que um peer, e pode ser transferido de qualquer um deles ou mesmo de vários deles ao mesmo tempo, por partes, com o intuito de melhorar a disponibilidade e o desempenho. Um peer que inicie a descarga de um dado ficheiro pode de imediato disponibilizá-lo a outros peers, mesmo que ainda esteja incompleto, em blocos devidamente identificados. O desempenho global melhora substancialmente com o número de réplicas disponíveis na rede. O serviço é levemente inspirado nas redes do tipo “BitTorrent”, mas espera-se que proponha no trabalho prático uma solução própria e inovadora.

- Objetivos:
	O objetivo deste trabalho é desenhar, implementar e testar um serviço de partilha de ficheiros peer-to-peer de alto desempenho. Para garantir um bom desempenho, a transferência deve ser feita com base num protocolo de transferência a correr sobre o protocolo de transporte UDP. Adicionalmente, o ficheiro deve ser previamente dividido em blocos devidamente identificados, que podem ser descarregados em paralelo de múltiplas localizações diferentes. No limite os N blocos que constituem um ficheiro podem ser descarregados ao mesmo tempo de N pares. Ao receber um dado bloco sem erros, um nó deve disponibilizá-lo imediatamente a outros possíveis pares da rede
P2P.
	Para ter acesso ao serviço, cada nó deve executar uma aplicação designada por FS_Node, que é simultaneamente cliente e servidor. Mal inicia a execução, o FS_Node conecta-se a um servidor de registo de conteúdos designado por FS_Tracker, e informa-o do seu endereço e os ficheiros ou blocos que possui na sua pasta partilhada. O FS_Tracker tem, pois, conhecimento atualizado de toda a rede, dos nós que a constituem, e dos ficheiros ou blocos disponíveis em cada um deles. De igual modo, quando pretende localizar e descarregar um ficheiro, um FS_Node deve em primeiro lugar interrogar o FS_Tracker para obter uma lista atualizada de localizações. De seguida corre um algoritmo de seleção de FS_Node e de escalonamento da transferências dos vários blocos que formam o ficheiro.
	
	O protocolo de localização de conteúdos que é usado na interação entre os FS_Node e o FS_Tracker é designado por FS Track Protocol e deve funcionar sobre uma conexão de transporte fiável TCP. Se essa conexão terminar, o FS_Node é declarado inativo e removido da base de informação do FS_Tracker. O protocolo de transferência, que regula as interações de troca de dados entre os FS_Node, designa-se por FS Transfer Protocol e deve funcionar sobre UDP para maior eficiência. Como se trata da transferência de ficheiros, este deve suportar a recuperação de blocos perdidos, emulando a fiabilidade presente em TCP. Adicionalmente, por modo a garantir uma performance adequada, poderá ser implementado também um sistema de monitorização da rede que priorize os utilizadores que oferecem as melhores condições de transferência para o ficheiro desejado (uma implementação simples poderá ser selecionar os peers pela ordem recebida pelo FS_Tracker).

- Descrição: 
	Damos agora um exemplo. Neste caso de uso estão envolvidos 4 máquina diferentes.
	Numa máquina coloca-se a funcionar a aplicação FS_Tracker que fica à escuta de conexões FS Track Protocol na porta TCP 9090. Este servidor manterá uma conexão ativa por cada FS_Node registado. Inicialmente não tem conhecimento de nenhum FS_Node e a sua base de informação interna está vazia. Em três outros sistemas colocam-se em execução instâncias da aplicação FS_Node. Quando inicia a execução, a aplicação começa por ler a pasta partilhada a seu cargo, que lhe é indicada como parâmetro ou via ficheiro de configuração, e conecta-se à porta TCP 9090 do FS_Tracker. Utiliza depois o protocolo FS Track Protocol para informar dos ficheiros ou blocos a seu cargo. Ao mesmo tempo, coloca-se à escuta, em permanência, na porta UDP 9090 por pedidos de blocos segundo o protocolo FS Transfer Protocol. A aplicação possui um pequeno interface em modo texto, de linha de comando, para permitir a interação com o utilizador. 

	A descarga de ficheiros pode ser iniciada por qualquer FS_Node da rede, a pedido do utilizador, que pode simplesmente digitar o nome do ficheiro (ex: GET File1). Ao receber uma indicação de descarga, o FS_Node interroga o FS_Tracker que lhe devolve uma lista dos FS_Node que possuem blocos desse ficheiros. De seguida corre um algoritmo de seleção que os ordena com vista ao máximo desempenho e um algoritmo de escalonamento que decide em cada instante quantos e quais blocos deve pedir a cada FS_Node. O objetivo é sempre maximizar o desempenho.
